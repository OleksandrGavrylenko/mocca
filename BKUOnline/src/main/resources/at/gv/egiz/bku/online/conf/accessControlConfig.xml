<?xml version="1.0" encoding="UTF-8"?>
<AccessControl>
	<Chains>
		<!--
			The input chain defines filters that are applied before command
			execution
		-->
		<Chain Id="InputChain">
			<Rules>
				<!-- there is no command implemented that requires input filtering -->
				<Rule Id="InputChain-AllowAll">
					<Action>
						<RuleAction>allow</RuleAction>
					</Action>
					<UserInteraction>confirm</UserInteraction>
				</Rule>
			</Rules>
		</Chain>

		<!--
			The output chain defines filters that are applied after command
			execution
		-->
		<Chain Id="OutputChain">
			<Rules>
				<Rule Id="OutputChain-Egov">
					<AuthClass>certifiedGovAgency</AuthClass>
					<Action>
						<RuleAction>allow</RuleAction>
					</Action>
					<UserInteraction>confirm</UserInteraction>
				</Rule>
				<Rule Id="OutputChain-Command">
					<AuthClass>anonymous</AuthClass>
					<Action>
						<ChainRef>Command</ChainRef>
					</Action>
				</Rule>
			</Rules>
		</Chain>
		<Chain Id="Command">
			<Rules>
				<Rule Id="cmd-rule-1">
					<AuthClass>certified</AuthClass>
					<AnyPeer />
					<Command Name="Infobox*">
						<Param Name="InfoboxIdentifier">IdentityLink</Param>
						<Param Name="PersonIdentifier">derived</Param>
					</Command>
					<Action>
						<RuleAction>allow</RuleAction>
					</Action>
					<UserInteraction>confirm</UserInteraction>
				</Rule>
				<Rule Id="cmd-rule-2">
					<AuthClass>anonymous</AuthClass>
					<Command Name="Infobox.*">
						<Param Name="InfoboxIdentifier">IdentityLink</Param>
					</Command>
					<Action>
						<RuleAction>deny</RuleAction>
					</Action>
					<UserInteraction>info</UserInteraction>
				</Rule>
				<Rule Id="cmd-rule-3">
					<Action>
						<RuleAction>allow</RuleAction>
					</Action>
				</Rule>
			</Rules>
		</Chain>
	</Chains>
</AccessControl>
